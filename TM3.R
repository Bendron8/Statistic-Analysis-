dados <- matrix(c(
  1.71976217672389, 1.46608814700658,
  1.88491125525836, 1.89101254267085,
  2.77935415707456, 1.48699777584638,
  2.03525419571229, 1.63555438535443,
  2.06464386758047, 1.68748036607537,
  2.85753249344164, 1.15665334462879,
  2.2304581029946, 2.41889352224726,
  1.36746938269673, 2.07668655891826,
  1.65657357405324, 1.43093153149403,
  1.77716901495002, 2.62690746053496,
  2.61204089871973, 2.21323211073841,
  2.17990691352868, 1.85246425850386,
  2.20038572529703, 2.44756283052251,
  2.05534135797256, 2.43906674376652,
  1.72207943262296, 2.41079054081874,
  2.89345656840154, 2.34432012705005,
  2.24892523911462, 2.27695882676879,
  1.01669142168518, 1.96904414471164,
  2.35067795078184, 1.84701866813004,
  1.76360429613603, 1.80976449949381,
  7.65264651053974, 8.18981974137994,
  7.8960413609902, 7.74883827344535,
  7.36730182421587, 7.83339630816529,
  9.08447798266926, 7.49071230844646,
  8.6039809991525, 7.46410438676221,
  7.43844570839833, 8.15176432070213,
  7.79855758235046, 8.22410488931471,
  7.76667232318839, 8.02650211336525,
  8.38998255916816, 8.46113373393987,
  7.95831546676408, 9.02504234281357,
  8.12665925699738, 7.75448441697173,
  7.98572662232565, 6.84541556217959,
  7.97856477135434, 8.50286926223113,
  8.68430114200723, 7.6453996187088,
  7.88711450717037, 7.65599569176632,
  8.75823530221477, 8.51278568484835,
  7.22562359788489, 7.8576134964745,
  8.29230687481803, 7.38964114387273,
  8.06192712192231, 8.09065173987458,
  8.10797078437199, 7.93055431878048,
  14.0028820929499, 13.6447967181503,
  14.1926402005632, 14.1284418545783,
  13.8146699841038, 13.8766540607688,
  14.3221882742594, 13.8262287003011,
  13.8897567190906, 13.5241907163675,
  14.1658909819578, 13.9774861375955,
  14.5484195065747, 13.6075477652715,
  14.2175907454169, 13.1660290317059,
  13.8370342072344, 13.8098867398561,
  14.5744038092255, 14.4594983045304,
  14.4967519279811, 13.7123265186958,
  14.274198479754, 14.3039821611125,
  14.1193658675557, 13.1910586458554,
  13.6860469619803, 13.9722190172377,
  14.680326224265, 14.2597036019717,
  13.6998702064264, 14.1505766810834,
  15.0936664965083, 14.0528380970745,
  14.7663053130926, 13.6796469958473,
  13.8821498204498, 13.5751478269832,
  13.4867895498466, 13.4879356046975),
  ncol = 2, byrow = TRUE)

n <- nrow(dados)
num <- 3
tamanho <- n / num


grupos <- matrix(0, nrow = tamanho, ncol = num)
atual <- 1
indices <- rep(FALSE, n)


dist <- function(p1, p2) {
  sqrt((p1[1] - p2[1])^2 + (p1[2] - p2[2])^2)
}

mais_prox <- function(atual, indices) {
  menor_dist <- Inf
  indice_prox <- -1
  for (i in 1:n) {
    if (!indices[i]) {  # ignora pontos ja atribuidos
      dist <- dist(dados[atual, ], dados[i, ])
      if (dist < menor_dist) {
        menor_dist <- dist
        indice_prox <- i
      }
    }
  }
  return(indice_prox)
}


for (g in 1:num) {
  
  inicial <- sample(which(!indices), 1)
  grupos[1, g] <- inicial
  indices[inicial] <- TRUE
  
   
  for (i in 2:tamanho) {
    ponto_prox <- mais_prox(grupos[i - 1, g], indices)
    grupos[i, g] <- ponto_prox
    indices[ponto_prox] <- TRUE
  }
}


for (g in 1:num) {
  cat(sprintf("Grupo %d:\n", g))
  for (i in 1:tamanho) {
    cat(sprintf("[%.6f, %.6f]\n", dados[grupos[i, g], 1], dados[grupos[i, g], 2]))
  }
  cat("\n")
}


  
